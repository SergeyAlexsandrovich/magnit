{"version":3,"sources":["components/section-title/SectionTitle.tsx","components/section-title/index.ts","components/section-layout/SectionLayout.tsx","components/section-layout/index.ts","components/centered-section-item/CenteredSectionItem.tsx","components/list/EmptyList.tsx","components/list/index.ts","containers/templates/TemplateList.tsx","containers/templates/CreateTemplate.tsx","containers/templates/EditTemplate.tsx","containers/templates/index.ts"],"names":["SectionTitle","title","children","Grid","item","css","height","boxShadow","Paper","square","display","alignItems","container","theme","paddingLeft","spacing","paddingRight","xs","Typography","variant","component","displayName","SectionLayout","direction","width","minHeight","CenteredSectionItem","flexDirection","justifyContent","EmptyList","button","justify","alignContent","marginBottom","align","color","colors","black","fontWeight","fontSize","xLarge","secondary","larger","columns","key","label","sortable","TemplateList","context","useContext","AppContext","useState","rows","setRows","page","setPage","redirect","to","setRedirect","fetchTemplatesAndSetState","useCallback","getTemplates","courier","then","response","templates","map","template","createdAt","getFriendlyDate","Date","updatedAt","catch","console","error","useEffect","onDeleteTemplateCallback","id","deleteTemplate","setSnackbarState","open","message","setSnackbarError","renderMenuItems","row","onMenuClose","MenuItem","onClick","event","stopPropagation","empty","length","noThrow","hidden","Link","scheme","margin","lightGray","marginTop","padding","placeholder","fullWidth","radius","borderRadius","background","white","border","transition","cursor","primary","div","input","data","onRowClick","onChangePage","nextPage","CreateTemplate","sections","description","type","ETemplateType","LIGHT","setTemplate","setError","snackbar","setSnackbar","file","a","uploadFile","filename","process","deleteFile","createTemplate","disabled","maxWidth","maxTemplateWidth","position","opacity","pointerEvents","main","onChange","onAddAsset","onDeleteAsset","onClose","reason","setTimeout","EditTemplate","templateId","getTemplate","updateTemplate"],"mappings":"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","file":"static/js/2.6bb5649a.chunk.js","sourcesContent":["/** @jsx jsx */\n\nimport { jsx } from \"@emotion/core\";\nimport { Grid, Paper, Typography } from \"@material-ui/core\";\nimport * as React from \"react\";\n\ninterface ISectionTitleProps {\n    title: string;\n}\n\nexport const SectionTitle: React.FC<ISectionTitleProps> = ({ title, children }) => {\n    return (\n        <Grid\n            item\n            css={{\n                height: \"var(--section-title-height)\",\n                boxShadow: \"0 6px 20px rgba(220, 227, 235, 0.3)\",\n            }}\n        >\n            <Paper\n                square={true}\n                css={{\n                    height: \"100%\",\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    boxShadow: \"none !important\",\n                }}\n            >\n                <Grid\n                    container\n                    css={theme => ({\n                        paddingLeft: theme.spacing(4),\n                        paddingRight: theme.spacing(4),\n                    })}\n                >\n                    <Grid item xs>\n                        <Typography variant=\"h4\" component=\"div\">\n                            <span>{title}</span>\n                        </Typography>\n                    </Grid>\n                    {children}\n                </Grid>\n            </Paper>\n        </Grid>\n    );\n};\n\nSectionTitle.displayName = \"SectionTitle\";\n","export * from \"./SectionTitle\";\n","/** @jsx jsx */\n\nimport { jsx } from \"@emotion/core\";\nimport { Grid } from \"@material-ui/core\";\nimport * as React from \"react\";\n\nexport const SectionLayout: React.FC = ({ children }) => {\n    return (\n        <Grid\n            container\n            direction=\"column\"\n            css={{\n                width: \"100%\",\n                minHeight: \"100vh\",\n            }}\n        >\n            {children}\n        </Grid>\n    );\n};\n\nSectionLayout.displayName = \"SectionLayout\";\n","export * from \"./SectionLayout\";\n","/** @jsx jsx */\n\nimport { jsx } from \"@emotion/core\";\nimport { Grid } from \"@material-ui/core\";\nimport * as React from \"react\";\n\nexport const CenteredSectionItem: React.FC = ({ children }) => {\n    return (\n        <Grid\n            item\n            xs\n            css={{\n                display: \"flex\",\n                flexDirection: \"column\",\n                justifyContent: \"center\",\n                alignItems: \"center\",\n            }}\n        >\n            {children}\n        </Grid>\n    );\n};\n\nCenteredSectionItem.displayName = \"CenteredSectionItem\";\n","/** @jsx jsx */\n\nimport { Grid, Typography } from \"@material-ui/core\";\nimport { jsx } from \"@emotion/core\";\nimport { CenteredSectionItem } from \"components/centered-section-item\";\nimport * as React from \"react\";\n\ninterface IEmptyListProps {\n    title: string;\n    button?: React.ReactNode;\n}\n\nexport const EmptyList: React.FC<IEmptyListProps> = ({ title, button, children }) => {\n    return (\n        <CenteredSectionItem>\n            <Grid container justify=\"center\" alignContent=\"center\" direction=\"column\">\n                <Grid item css={theme => ({ marginBottom: theme.spacing(3) })}>\n                    <Typography\n                        component=\"div\"\n                        align=\"center\"\n                        css={theme => ({\n                            color: theme.colors.black,\n                            fontWeight: 500,\n                            fontSize: theme.fontSize.xLarge,\n                        })}\n                    >\n                        <span>{title}</span>\n                    </Typography>\n                </Grid>\n                <Grid item css={theme => ({ marginBottom: theme.spacing(3) })}>\n                    <Typography\n                        component=\"div\"\n                        align=\"center\"\n                        css={theme => ({\n                            color: theme.colors.secondary,\n                            fontSize: theme.colors.larger,\n                        })}\n                    >\n                        {children}\n                    </Typography>\n                </Grid>\n                <Grid item>\n                    <Grid container justify=\"center\" alignContent=\"center\">\n                        <Grid item>{button}</Grid>\n                    </Grid>\n                </Grid>\n            </Grid>\n        </CenteredSectionItem>\n    );\n};\n\nEmptyList.displayName = \"EmptyList\";\n","export * from \"./EmptyList\";\n","/** @jsx jsx */\n\nimport { jsx } from \"@emotion/core\";\nimport { Button, IColumn, InputField, ITableDataItem, TableWrapper } from \"@magnit/components\";\nimport { AddIcon } from \"@magnit/icons\";\nimport { getFriendlyDate } from \"@magnit/services\";\nimport { Grid, MenuItem, Paper, Typography } from \"@material-ui/core\";\nimport { Link, Redirect } from \"@reach/router\";\nimport { EmptyList } from \"components/list\";\nimport { SectionLayout } from \"components/section-layout\";\nimport { SectionTitle } from \"components/section-title\";\nimport { AppContext } from \"context\";\nimport * as React from \"react\";\nimport { useCallback, useContext, useEffect, useState } from \"react\";\nimport { deleteTemplate, getTemplates, ITemplateResponse } from \"services/api/templates\";\n\nconst columns: IColumn[] = [\n    { key: \"title\", label: \"Название шаблона\", sortable: true },\n    { key: \"description\", label: \"Описание\", sortable: true },\n    { key: \"createdAt\", label: \"Дата создания\", sortable: true },\n    { key: \"updatedAt\", label: \"Дата редактирования\", sortable: true },\n];\n\nexport const TemplateList: React.FC = () => {\n    const context = useContext(AppContext);\n\n    // table\n    const [rows, setRows] = useState<ITemplateResponse[]>([]);\n    const [page, setPage] = useState(0);\n\n    // redirect to row\n    const [redirect, setRedirect] = useState({ redirect: false, to: \"\" });\n\n    const fetchTemplatesAndSetState = useCallback(() => {\n        getTemplates(context.courier)\n            .then(response => {\n                response.templates = response.templates.map(template => {\n                    return {\n                        ...template,\n                        createdAt: getFriendlyDate(new Date(template.createdAt!), true),\n                        updatedAt: getFriendlyDate(new Date(template.updatedAt!), true),\n                    };\n                });\n                setRows(response.templates);\n            })\n            .catch(console.error);\n    }, [context.courier]);\n\n    useEffect(() => fetchTemplatesAndSetState(), [context.courier, fetchTemplatesAndSetState]);\n\n    function onRowClick(row?: ITableDataItem) {\n        if (!row) {\n            return;\n        }\n        setRedirect({ redirect: true, to: row.id });\n    }\n\n    function onChangePage(nextPage: number) {\n        setPage(nextPage);\n    }\n\n    const onDeleteTemplateCallback = useCallback(\n        (id: number) => {\n            deleteTemplate(context.courier, id)\n                .then(() => {\n                    fetchTemplatesAndSetState();\n                    context.setSnackbarState({ open: true, message: \"Шаблон успешно удалён\" });\n                })\n                .catch(() => {\n                    context.setSnackbarError(true);\n                    context.setSnackbarState({ open: true, message: \"Не удалось удалить шаблон\" });\n                });\n        },\n        [context, fetchTemplatesAndSetState],\n    );\n\n    const renderMenuItems = useCallback(\n        (row: ITableDataItem, onMenuClose: () => void) => {\n            function onDeleteClick(event: React.MouseEvent<HTMLLIElement>) {\n                event.stopPropagation();\n                onDeleteTemplateCallback(row.id);\n                onMenuClose();\n            }\n\n            return [\n                <MenuItem key={row.id} onClick={onDeleteClick}>\n                    Удалить\n                </MenuItem>,\n            ];\n        },\n        [onDeleteTemplateCallback],\n    );\n\n    const empty = !rows.length;\n\n    return (\n        <SectionLayout>\n            {redirect.redirect && <Redirect to={`templates/edit/${redirect.to}`} noThrow />}\n            <SectionTitle title=\"Список шаблонов\">\n                <Grid item hidden={empty}>\n                    <Button component={Link} to=\"create\" variant=\"contained\" scheme=\"blue\">\n                        <AddIcon />\n                        <Typography>Создать шаблон</Typography>\n                    </Button>\n                </Grid>\n            </SectionTitle>\n            {empty && (\n                <EmptyList\n                    title=\"Шаблонов нет\"\n                    button={\n                        <Button component={Link} to=\"create\" scheme=\"blue\">\n                            <AddIcon />\n                            <Typography>Создать шаблон</Typography>\n                        </Button>\n                    }\n                >\n                    <div>Для создания шаблона нажмите кнопку</div>\n                    <div>Создать шаблон</div>\n                </EmptyList>\n            )}\n            {!empty && (\n                <Paper\n                    square={true}\n                    css={({ colors, spacing }) => ({\n                        margin: spacing(3),\n                        boxShadow: `0 0 ${spacing(2)} ${colors.lightGray} !important`,\n                    })}\n                >\n                    <Grid\n                        container\n                        direction=\"row\"\n                        css={theme => ({ marginTop: theme.spacing(2) })}\n                    >\n                        <Grid\n                            container\n                            direction=\"column\"\n                            css={theme => ({ padding: theme.spacing(3) })}\n                        >\n                            <Grid container direction=\"row\" spacing={2}>\n                                <Grid\n                                    item\n                                    xs\n                                    css={theme => ({ padding: `0 ${theme.spacing(6)} !important` })}\n                                >\n                                    <InputField\n                                        placeholder=\"Поиск ...\"\n                                        fullWidth\n                                        css={({ colors, radius, spacing }) => ({\n                                            borderRadius: radius(5),\n                                            background: colors.white,\n                                            border: `1px solid ${colors.lightGray}`,\n                                            transition: \"border 0.25s ease-in-out\",\n                                            cursor: \"pointer\",\n                                            \":hover, :active\": {\n                                                border: `1px solid ${colors.primary}`,\n                                            },\n                                            div: {\n                                                \":before, :after\": { border: \"none !important\" },\n                                            },\n                                            input: { padding: `${spacing(2)} ${spacing(4)}` },\n                                        })}\n                                    />\n                                </Grid>\n                            </Grid>\n                            <Grid item css={theme => ({ padding: theme.spacing(3) })}>\n                                <TableWrapper\n                                    page={page}\n                                    columns={columns}\n                                    renderMenuItems={renderMenuItems}\n                                    data={rows}\n                                    onRowClick={onRowClick}\n                                    onChangePage={onChangePage}\n                                />\n                            </Grid>\n                        </Grid>\n                    </Grid>\n                </Paper>\n            )}\n        </SectionLayout>\n    );\n};\n","/** @jsx jsx */\n\nimport { jsx } from \"@emotion/core\";\nimport { Button } from \"@magnit/components\";\nimport { ETemplateType, ITemplate } from \"@magnit/entities\";\nimport { CheckIcon } from \"@magnit/icons\";\nimport { TemplateEditor } from \"@magnit/template-editor\";\nimport { Grid, Typography } from \"@material-ui/core\";\nimport { SectionLayout } from \"components/section-layout\";\nimport { SectionTitle } from \"components/section-title\";\nimport { Snackbar } from \"components/snackbar\";\nimport { AppContext } from \"context\";\nimport * as React from \"react\";\nimport { useContext, useState } from \"react\";\nimport { deleteFile, uploadFile } from \"services/api/assets\";\nimport { createTemplate } from \"services/api/templates\";\n\nexport const CreateTemplate: React.FC = () => {\n    const context = useContext(AppContext);\n    const [template, setTemplate] = useState<ITemplate>({\n        id: 0,\n        sections: [],\n        title: \"\",\n        description: \"\",\n        type: ETemplateType.LIGHT,\n    });\n    const [error, setError] = useState(false); // success/error snackbar state\n    const [snackbar, setSnackbar] = useState({\n        open: false,\n        message: \"\",\n    }); // open/close snackbar\n\n    function onTemplateChange(template: ITemplate) {\n        setTemplate({ ...template });\n    }\n\n    function onSnackbarClose(event?: React.SyntheticEvent, reason?: string) {\n        if (reason === \"clickaway\") {\n            return;\n        }\n        setSnackbar({ open: false, message: \"\" });\n        // wait till animation ends\n        setTimeout(() => setError(false), 100);\n    }\n\n    function onTemplateSave() {\n        createTemplate(context.courier, template)\n            .then(() => setSnackbar({ open: true, message: \"Шаблон успешно сохранён!\" }))\n            .catch(() => {\n                setSnackbar({ open: true, message: \"Ошибка сохранения шаблона!\" });\n                setError(true);\n            });\n    }\n\n    async function onAddAsset(file: File) {\n        return uploadFile(context.courier, file).then(response => ({\n            ...response,\n            filename: `${process.env.REACT_APP_BACKEND_URL}/${response.filename}`,\n        }));\n    }\n\n    async function onDeleteAsset(filename: string) {\n        return deleteFile(context.courier, filename);\n    }\n\n    return (\n        <SectionLayout>\n            <SectionTitle title=\"Создание шаблона\">\n                <Grid item>\n                    <Button\n                        variant=\"contained\"\n                        scheme=\"green\"\n                        onClick={onTemplateSave}\n                        disabled={snackbar.open}\n                    >\n                        <CheckIcon />\n                        <Typography>Сохранить</Typography>\n                    </Button>\n                </Grid>\n            </SectionTitle>\n            <Grid\n                css={theme => ({\n                    maxWidth: theme.maxTemplateWidth,\n                    margin: theme.spacing(4),\n                    position: \"relative\",\n                    opacity: snackbar.open ? 0.5 : 1,\n                    transition: \"opacity 0.3s ease-in-out\",\n                    pointerEvents: snackbar.open ? \"none\" : \"initial\",\n                })}\n            >\n                <TemplateEditor\n                    template={template}\n                    css={theme => ({ background: theme.colors.main })}\n                    onChange={onTemplateChange}\n                    onAddAsset={onAddAsset}\n                    onDeleteAsset={onDeleteAsset}\n                />\n            </Grid>\n            <Snackbar\n                open={snackbar.open}\n                error={error}\n                onClose={onSnackbarClose}\n                message={snackbar.message}\n            />\n        </SectionLayout>\n    );\n};\n","/** @jsx jsx */\n\nimport { jsx } from \"@emotion/core\";\nimport { Button } from \"@magnit/components\";\nimport { ETemplateType, ITemplate } from \"@magnit/entities\";\nimport { CheckIcon } from \"@magnit/icons\";\nimport { TemplateEditor } from \"@magnit/template-editor\";\nimport { Grid, Typography } from \"@material-ui/core\";\nimport { SectionLayout } from \"components/section-layout\";\nimport { SectionTitle } from \"components/section-title\";\nimport { Snackbar } from \"components/snackbar\";\nimport { AppContext } from \"context\";\nimport * as React from \"react\";\nimport { useContext, useEffect, useState } from \"react\";\nimport { deleteFile, getTemplate, updateTemplate, uploadFile } from \"services/api\";\n\ninterface IEditTemplateProps {\n    templateId: number;\n}\n\nexport const EditTemplate: React.FC<IEditTemplateProps> = ({ templateId }) => {\n    const context = useContext(AppContext);\n    const [template, setTemplate] = useState<ITemplate>({\n        id: 0,\n        sections: [],\n        title: \"\",\n        description: \"\",\n        type: ETemplateType.LIGHT,\n    });\n    const [error, setError] = useState(false); // success/error snackbar state\n    const [snackbar, setSnackbar] = useState({\n        open: false,\n        message: \"\",\n    }); // open/close snackbar\n\n    useEffect(() => {\n        getTemplate(context.courier, templateId)\n            .then(response => setTemplate(response.template))\n            .catch(console.error);\n    }, [context.courier, templateId]);\n\n    function onTemplateChange(template: ITemplate) {\n        setTemplate({ ...template });\n    }\n\n    function onSnackbarClose(event?: React.SyntheticEvent, reason?: string) {\n        if (reason === \"clickaway\") {\n            return;\n        }\n        setSnackbar({ open: false, message: \"\" });\n        // wait till animation ends\n        setTimeout(() => setError(false), 100);\n    }\n\n    function onTemplateSave() {\n        updateTemplate(context.courier, templateId, template)\n            .then(() => setSnackbar({ open: true, message: \"Шаблон успешно обновлён!\" }))\n            .catch(() => {\n                setSnackbar({ open: true, message: \"Ошибка обновления шаблона!\" });\n                setError(true);\n            });\n    }\n\n    async function onAddAsset(file: File) {\n        return uploadFile(context.courier, file).then(response => ({\n            ...response,\n            filename: `${process.env.REACT_APP_BACKEND_URL}/${response.filename}`,\n        }));\n    }\n\n    async function onDeleteAsset(filename: string) {\n        return deleteFile(context.courier, filename);\n    }\n\n    return (\n        <SectionLayout>\n            <SectionTitle title=\"Редактирование шаблона\">\n                <Grid item>\n                    <Button\n                        variant=\"contained\"\n                        scheme=\"blue\"\n                        onClick={onTemplateSave}\n                        disabled={snackbar.open}\n                    >\n                        <CheckIcon />\n                        <Typography>Обновить</Typography>\n                    </Button>\n                </Grid>\n            </SectionTitle>\n            <Grid\n                css={theme => ({\n                    maxWidth: theme.maxTemplateWidth,\n                    margin: theme.spacing(4),\n                    position: \"relative\",\n                    transition: \"opacity 0.3s ease-in-out\",\n                })}\n            >\n                <TemplateEditor\n                    template={template}\n                    css={theme => ({ background: theme.colors.main })}\n                    onChange={onTemplateChange}\n                    onAddAsset={onAddAsset}\n                    onDeleteAsset={onDeleteAsset}\n                />\n            </Grid>\n            <Snackbar\n                open={snackbar.open}\n                error={error}\n                onClose={onSnackbarClose}\n                message={snackbar.message}\n            />\n        </SectionLayout>\n    );\n};\n","export * from \"./TemplateList\";\nexport * from \"./CreateTemplate\";\nexport * from \"./EditTemplate\";\n"],"sourceRoot":""}